function clearSelect(e){var t=document.getElementById(e),n=t.length;for(i=0;i<n;i++)t.options[i].selected=""}var jreviews=jreviews||{},jrPage,jrAdmin;jreviews.admin=!0;(function(e){e(document).ajaxSend(function(){e("div.jr-page-spinner").show()}).ajaxComplete(function(){e("div.jr-page-spinner").fadeOut()}).ajaxStop(function(){jreviews.addOnloadAjax("datepicker",jreviews.datepicker);jreviews.addOnloadAjax("images",jreviews.page.loadImages);jreviews.addOnloadAjax("group-location",jreviews.group.changeLocation);e.each(jreviews._onloadFnAjax,function(e,t){t!==undefined&&t()})});jreviews.apply=!1;jreviews=e.extend(jreviews,{lang:jreviews.lang||{},_onloadFn:[],_onloadFnAjax:[],_onloadFnKeys:[],_onloadFnAjaxKeys:[]});jreviews.addOnload=function(t,n){if(e.inArray(t,jreviews._onloadFnKeys)===-1){jreviews._onloadFn.push(n);jreviews._onloadFnKeys.push(t)}};jreviews.addOnloadAjax=function(t,n){if(e.inArray(t,jreviews._onloadFnAjaxKeys)===-1){jreviews._onloadFnAjax.push(n);jreviews._onloadFnAjaxKeys.push(t)}};jreviews.onload=function(){jreviews.addOnload("stats",jreviews.stats);jreviews.addOnload("news-feed",jreviews.newsFeed);jreviews.addOnload("version-check",jreviews.versionCheck);jreviews.addOnload("menus",jreviews.menu.init);jreviews.addOnload("license",jreviews.license.init);jreviews.addOnload("installer",jreviews.installer.init);jreviews.addOnload("datepicker",jreviews.datepicker);jreviews.addOnload("popup",jreviews.popup);jreviews.addOnload("tabs",jreviews.tabs);jreviews.addOnload("form-checkall",jreviews.tools.checkAll);jreviews.addOnload("open-site-url",jreviews.openSiteUrl);jreviews.addOnload("image-delayed",jreviews.imageDelayed);jreviews.addOnload("about",jreviews.about.init);jreviews.addOnload("moderation",jreviews.moderation.init);jreviews.addOnload("listing-browse",jreviews.listing.browse);jreviews.addOnload("review-browse",jreviews.review.browse);jreviews.addOnload("media-browse",jreviews.media.browse);jreviews.addOnload("media-submit",jreviews.media.init);jreviews.addOnload("moderation",jreviews.moderation.init);jreviews.addOnload("configuration",jreviews.config.init);jreviews.addOnload("group",jreviews.group.init);jreviews.addOnload("field",jreviews.field.init);jreviews.addOnload("listing-type",jreviews.listing_type.init);jreviews.addOnload("theme",jreviews.theme.init);jreviews.addOnload("page-init",jreviews.page.init);e.each(jreviews._onloadFn,function(e,t){t!==undefined&&t()})};head.ready(function(){e("#toolbar-box,#submenu-box").remove();e(".subhead-collapse").remove();jrPage=e("div.jr-page");jrAdmin=e("#jr-admin");jreviews.onload()});jreviews.__t=function(t,n){var r={add_ul:!0};n=e.extend(r,n);if(typeof t=="string")return jreviews.lang[t]||t;var i=[];e.each(t,function(e,t){var n,r;if(typeof t=="string")n=jreviews.lang[t]||t;else{r=jreviews.lang[t.shift()];t.unshift(r);n=window.sprintf.apply(null,t)}i.push("<li>"+n+"</li>")});return n.add_ul?"<ul>"+i.join("")+"</ul>":i.join("")};jreviews.dispatch=function(t){t=t||{};var n=t.form_id!==undefined||t.form!==undefined?"POST":"GET";undefined!==t.method&&(n=t.method);var r=t.controller!==undefined?e.param({"data[controller]":t.controller,"data[action]":t.action}):{},i=t.type||"json",s=t.frontend?s2AjaxUri.replace(/administrator\//,"",s2AjaxUri):s2AjaxUri;if(undefined!==t.form_id||undefined!==t.form){var o=t.form||e("#"+t.form_id);undefined!==t.controller&&o.find("input[name=data\\[controller\\]], input[name=data\\[action\\]]").remove();r=o.serialize()+"&"+r}t.data&&(r=r+"&"+e.param(t.data));return e.ajax({type:n,url:s,data:r,dataType:t.type})};jreviews.versionCheck=function(){var t=jreviews.dispatch({method:"get",controller:"admin/common",action:"getVersion"});t.done(function(t){if(t.isNew){var n=e('<button class="jrButton jrGreen">'+jreviews.__t("NEW_VERSION_AVAILABLE")+"</a>");n.on("click",function(e){e.preventDefault();jreviews.menu.load("admin_updater","index")});e("#jr-version").html(n).fadeIn()}})};jreviews.openSiteUrl=function(){jrPage.on("click","a.jr-site-url, button.jr-site-url",function(t){t.preventDefault();var n=e(this),r=n.data("ids"),i=jreviews.dispatch({method:"get",type:"text",controller:"admin/admin_reports",action:"_getSiteUrl",data:r});i.done(function(e){if(e!==""){var t=window.open(e,"siteWindow","width=800,height=640");t.focus()}})})};jreviews.imageDelayed=function(){jrPage.find("img").attr("src",e(this).data("src"))};jreviews.datepicker=function(){if(e().datepicker){try{jreviews.datepickerClear()}catch(t){}e.datepicker.setDefaults({showOn:"both",buttonImage:jreviews.calendar_img,showButtonPanel:!0,buttonImageOnly:!0,buttonText:"Calendar",dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0});e('.jr-date:not(".jr_ready")').addClass("jr-ready").each(function(){e(this).datepicker({yearRange:e(this).data("yearrange"),minDate:e(this).data("mindate"),maxDate:e(this).data("maxdate")})})}};jreviews.datepickerClear=function(){var t=e.datepicker._updateDatepicker;e.datepicker._updateDatepicker=function(n){t.call(this,n);var r=e(this).datepicker("widget").find(".ui-datepicker-buttonpane");r.find(".clearDate").length===0&&e("<button class='clearDate' type='button' class='ui-datepicker-clean ui-state-default ui-priority-primary ui-corner-all'>"+jreviews.__t("CLEAR_DATE")+"</button>").appendTo(r).click(function(t){e.datepicker._clearDate(n.input)})}};jreviews.newsFeed=function(){var e=jrPage.find("div#jr-news-feed");if(e.length){var t=e.find("#news-spinner"),n=jreviews.dispatch({method:"get",type:"html",controller:"admin/common",action:"feed"});n.done(function(n){t.hide();e.find("#news-content").html(n).slideDown("slow")})}};jreviews.stats=function(){var t=jreviews.dispatch({method:"get",type:"json",controller:"admin/common",action:"getStats"});t.done(function(t){e.each(t,function(e,t){jrPage.find(".jr-stats-"+e).html(t)});jrPage.find('span[class^="jr-stats-"]').fadeIn()})};jreviews.page={init:function(){var t=jrPage;e(window).keydown(function(t){if(t.keyCode===13){if(e(t.target).prop("type")=="textarea")return!0;t.preventDefault();e(t.target).trigger("blur");return!1}});jreviews.page.pageNav(t);t.on("click","a.jr-insert-ip",function(){e(this).prev("span").find("input").val(jreviews.ipaddress)});t.on("click","img.jr-edit, a.jr-edit, div.jr-edit, button.jr-edit",function(n){n.preventDefault();var r=e(this),i=r.closest("form"),s=i.data("object-type"),o=r.data("object-type");o&&(s=o);jreviews[s].edit(e(this),t)});t.on("click","button.jr-save-settings",function(n){n.preventDefault();var r=e(this),i=r.closest("form"),s=jreviews.dispatch({type:"html",form:i});s.done(function(e){e!==""?t.html(e).promise().done(function(){jreviews.tools.statusUpdate(jreviews.__t("SETTINGS_SAVED"))}):jreviews.tools.statusUpdate(jreviews.__t("SETTINGS_SAVED"))})});t.on("click","button.jr-cancel",function(n){n.preventDefault();var r=t.children("div").eq(0),i=jreviews.getController(r,!0),s=jrAdmin.data("prevPage."+i);r.find(".jr-wysiwyg-editor").RemoveTinyMCE();s.insertBefore(r).fadeIn("fast");r.remove();e.removeData(jrAdmin,"prevPage."+i)});t.on("click","button.jr-publish",function(t){t.preventDefault();jreviews.page.publish(e(this))});t.on("click","button.jr-toggle",function(t){t.preventDefault();jreviews.page.toggle(e(this))});t.on("click","form#jr-page-form button.jr-delete",function(n){n.preventDefault();var r=e(this),i=r.closest(".jr-layout-outer");t.find(".jr-row-cb").removeAttr("checked");i.find(".jr-row-cb").attr("checked","checked");jreviews.page.del(e(this),t)});t.on("click","form#jr-page-form button.jr-delete-all",function(n){n.preventDefault();jreviews.page.del(e(this),t)});t.on("click","div.jr-moderation button.jr-delete-moderation",function(t){t.preventDefault();jreviews.moderation.delModeration(e(this))});t.on("click","a.jr-reorder",function(n){n.preventDefault();jreviews.page.reorder(e(this),t)});t.on("update","div.jr-layout-outer",function(t){t.preventDefault();jreviews.page.update(e(this))});t.on("click","a.jr-popup-window",function(t){t.preventDefault();e(this).popUpWindow()});t.on("click",".jr-preview",function(t){t.preventDefault();var n=e(this),r=n.closest(".jr-layout-outer"),i=r.find(".jr-title a").html()||r.find(".jr-title").html()||"",s=r.find(".jr-preview-html").html(),o={};e.jrDialog(s,{buttons:o,title:i,width:"640px",height:480})});t.on("blur","input.jr-title",function(){var t=e(this),n=t.closest("form"),r=t.data("slug"),i=t.data("numbers")||!0,s=t.val(),o=t.data("slug-space")!==undefined?t.data("slug-space"):"-",u,a=n.find("."+r);if(r&&a.length&&s!==""&&a.val()===""){var f=a.attr("maxlength");u=jreviews.tools.slug(s,{numbers:i,spaceReplaceChar:o});f!==undefined&&f>0&&(u=u.substring(0,f));a.val(u)}});t.on("blur",'input.jr-name:not("[readonly]")',function(){var n=e(this),r=t.find(".jr-title"),i=r.closest("form"),s=r.data("slug"),o=r.data("numbers")||!0,u=n.val(),a=r.data("slug-space")!==undefined?r.data("slug-space"):"-",f,l=i.find("."+s);if(s&&l.length&&u!==""){f=jreviews.tools.slug(u,{numbers:o,spaceReplaceChar:a});l.val(f)}});t.on("mousemove",'form:not(".jr-ready-control-field")',function(){jreviews.field.control_setup(e(this));e(this).addClass("jr-ready-control-field")});t.on("click","a.jr-edit-inplace",function(n){n.preventDefault();jreviews.page.editInPlace(e(this),t)});t.on("change blur",".jr-categories-seo input,.jr-categories-seo textarea",function(t){t.preventDefault();var n=e(this),r=n.parents(".jr-layout-outer"),i=r.find("input,textarea").serializeArray(),s=jreviews.dispatch({method:"post",controller:"admin/categories",action:"_saveSeo",data:i})});t.on("mousemove","div.jr-sortable div.jr-layout-outer",function(){var n=e("div.jr-sortable"),r=e(this).data("group"),i=n.find('[data-group="'+r+'"]').first().data("order");n.data("min_order",i);n.sortable({axis:"y",items:'[data-group="'+r+'"]',containment:"parent",handle:".jr-sort-handle",cursor:"move",placeholder:"ui-state-highlight",forcePlaceholderSize:!0,stop:function(s,o){var u=[];t.find("div.jr-layout-outer").each(function(t,n){var s=e(this);s.data("group")===r&&s.data("order",t+i);u.push({id:s.data("id"),order:t+i})});var a=jreviews.getController(o.item),f=jreviews.dispatch({method:"post",controller:a,action:"reorder",data:{"data[min]":i,"data[order]":u}});n.sortable("destroy")}})}).on("mouseleave","mouseenter","div.jr-sortable div.jr-layout-outer",function(){t.find("div.jr-sortable").sortable("destroy")});t.on("click",".jr-edit-media",function(){jreviews.media.view(e(this))})},loadImages:function(){jrPage.find('img:not(".jr-img-ready")').each(function(){var t=e(this).data("src");t&&e(this).attr("src",t).addClass("jr-img-ready")})},publish:function(e){var t=e.data("id"),n=e.find("span").eq(0),r=e.data("states"),i=jreviews.getController(e),s=jreviews.dispatch({method:"get",type:"json",controller:i,action:"_publish",data:{id:t}});s.done(function(e){e.success&&n.attr("class",r[e.state])})},pageNav:function(t){t.on("click","div.jr-pagenav a",function(t){t.preventDefault();e(this).trigger("jrPageNav")});t.on("change","div.jr-pagenav select.jr-pagenav-limit, div.jr-filters select",function(t){t.preventDefault();e(this).trigger("jrPageNav")});t.on("blur",'div.jr-filters input[type=text]:not(".jr-date")',function(t){t.preventDefault();e(this).trigger("jrPageNav")});t.on("change","div.jr-filters .jr-date",function(t){t.preventDefault();e(this).trigger("jrPageNav")});t.on("click","button.jr-search",function(t){t.preventDefault();e(this).trigger("jrPageNav")});t.on("jrPageNav","div.jr-pagenav a, div.jr-pagenav select.jr-pagenav-limit, div.jr-filters select, div.jr-filters input[type=text], button.jr-search",function(n){n.preventDefault();var r=e(this),i=r.closest("form"),s=t.find("div.jr-pagenav"),o=t.find("div.jr-filters, div.jr-filters-search").find("input,select"),u=Number(e("div.jr-pagenav select.jr-pagenav-limit").first().find(":selected").text()),a=1,f=Number(s.find("a.jr-pagenav-page").last().html());if(r.hasClass("jr-pagenav-page"))a=Number(r.html());else if(r.hasClass("jr-pagenav-next")){a=Number(r.siblings("span.jr-pagenav-current").html())+1;a=a>f?a:a}else if(r.hasClass("jr-pagenav-prev")){a=Number(r.siblings("span.jr-pagenav-current").html())-1;a=a<0?1:a}var l=jreviews.getController(r),c=i.find('input[name="data[action]"]').val()||"index",h=o.serializeArray();h.push({name:"page",value:a});isNaN(u)?h.push({name:"limit",value:"all"}):undefined!==u&&h.push({name:"limit",value:u});var p=jreviews.dispatch({method:"get",type:"html",controller:l,action:c,data:h});p.done(function(e){t.html(e)})})},editInPlace:function(t,n){var r=t.parent("div").first(),i=r.height(),s=t.data("field-id"),o=t.data("type"),u=t.data("column"),a=t.data("label"),f=t.data("state")===1?e.trim(t.html()):"",l=t.html(),c={text:e('<input type="text">').css({width:"95%"}),textarea:e("<textarea>").css({width:"95%",height:"100px"})},h=e("<label>").html(a),p=e('<button class="jrButton jrSmall jrGreen"><span class="jrIconSave"></span> '+jreviews.__t("SAVE")+"</button>"),d=e('<button class="jrButton jrSmall "><span class="jrIconCancel"></span> '+jreviews.__t("CANCEL")+"</button>"),v=e('<div class="jrRight">').append(p,"&nbsp;",d);n.find("div.jr-eip-form").remove();r.height(i);t.hide();p.on("click",function(r){r.preventDefault();var i=jreviews.getController(t);f=e(this).closest(".jr-eip-form").find("input, textarea").val();var o={"data[fieldid]":s,"data[column]":u,"data[value]":f},a=jreviews.dispatch({method:"post",controller:i,action:"saveInPlace",data:o});a.done(function(){n.find("div.jr-eip-form").remove();f===""&&(f='<span class="jrIconEdit"></span>'+jreviews.__t("EDIT"));t.data("state",1).html(f).show()})});d.on("click",function(n){n.preventDefault();e(this).closest("div.jr-eip-form").remove();t.show()});f==='<span class="jrIconEdit"></span>'+jreviews.__t("EDIT")&&(f="");var m=e('<div class="jr-eip-form jrRoundedPanel">').css({width:"200px",position:"relative",top:"-5px",left:"-50px","z-index":1e3}).append(h,c[o].val(f).css("margin","5px 0"),v,e('<div class="jrClear">'));m.insertAfter(t).focus()},pageNavData:function(e){var t=e.find("div.jr-pagenav").last(),n=e.find("div.jr-filters").find("input,select"),r=Number(t.find("select.jr-pagenav-limit").find(":selected").text()),i=Number(t.find("span.jr-pagenav-current").html()||1),s=n.serializeArray();s.push({name:"page",value:i});undefined!==r&&s.push({name:"limit",value:r});return s},toggle:function(e){var t=e.data("id"),n=e.data("columns"),r=e.find("span").eq(0),i=e.data("states"),s=e.closest("form").data("object-type");n.id=t;n.object_type=s;var o=jreviews.dispatch({method:"get",type:"json",controller:"admin/common",action:"toggleState",data:n});o.done(function(e){e.success&&r.attr("class",i[e.state])})},reorder:function(e,t){var n=e.data(),r=e.data("id"),i=e.closest("div.jr-layout-outer"),s;jreviews.tools.flashRow(i);s=jreviews.getController(e);var o=jreviews.dispatch({method:"get",type:"html",controller:s,action:"reorder",data:n});o.done(function(e){t.html(e).promise().done(function(){var e=t.find('div.jr-layout-outer[data-id="'+r+'"]');jreviews.tools.flashRow(e)})})},update:function(t){var n=t.data("id"),r;r=jreviews.getController(t);var i=jreviews.dispatch({method:"get",type:"json",controller:r,action:"update",data:{id:n}});i.done(function(n){t.find("[data-key]").each(function(){var t=e(this),r=t.data("key").split("."),i=t.data("keyType"),s=n[r[0]][r[1]]||null,o;if(s!==null){o=e.isArray(s)?s.join(","):s;if(i=="class"){var u=t.data("states"),a=[];e.each(u,function(t,n){e.inArray(n,a)==-1&&a.push(n)});t.is("button,a")?t.children().first().removeClass(a.join(" ")).addClass(u[s]):t.removeClass(a.join(" ")).addClass(u[s])}else t.is(":input")?t.val(o):t.html(o)}});jreviews.tools.flashRow(t)});return i},del:function(t,n){var r=t.data("lang"),i=e("form#jr-page-form"),s=t.find("span").eq(1),o=i.data("extra-params"),u;u=jreviews.getController(t);var a=new e.Deferred;a.done(function(e){var t=i.find("input.jr-row-cb:checked"),n=t.serializeArray();n.push({name:"extra_params",value:o});var r=jreviews.dispatch({method:"get",type:"json",controller:u,action:"_delete",data:n});r.done(function(n){if(n.success){e.dialog("close");jreviews.tools.removeRow(t.closest(".jr-layout-outer"))}else if(n.str.length){e.dialog("option","buttons",[]);e.html(jreviews.__t(n.str))}else e.dialog("close")})});var f={};f[jreviews.__t("DELETE")]=function(){a.resolve(e(this))};f[jreviews.__t("CANCEL")]=function(){e(this).dialog("close")};e.jrDialog(r.del_confirm,{buttons:f,title:s.html(),width:"640px"});var l=e(".ui-dialog-buttonpane");l.find("button:contains("+jreviews.__t("DELETE")+")").addClass("jrButton").prepend('<span class="jrIconDelete"></span>');l.find("button:contains("+jreviews.__t("CANCEL")+")").addClass("jrButton").prepend('<span class="jrIconCancel"></span>')}};jreviews.about={init:function(){var t=jrPage;t.on("click","button.jr-fixit",function(t){t.preventDefault();var n=e(this);task=n.data("task"),form=n.closest("form");form.find("input#jr-task").val(task);form.submit()})}};jreviews.installer={init:function(){var t=jrPage;t.on("click",'div.jr-installer button.jr-installer-update[data-status="1"]',function(n){n.preventDefault();jreviews.installer.update(e(this),t)});t.on("click","div.jr-installer button.jr-delete-addon",function(n){n.preventDefault();jreviews.installer.removeAddon(e(this),t)});t.on("change","div.jr-installer input#jr-betas",function(){var t={updater_betas:e(this).is(":checked")?"1":"0"},n=jreviews.dispatch({method:"get",controller:"admin/admin_updater",action:"betas",data:t});n.done(function(){jreviews.menu.load("admin_updater","index")})})},setButtonStates:function(){var e=jrPage;e.find('div.jr-installer button[data-status="1"]').css("color","orange");e.find('div.jr-installer button[data-status="1"]').css("color","green");e.find('div.jr-installer button[data-status="0"]').css("color","red").attr("disabled","disabled")},update:function(t,n){var r=t.data("title"),i=t.data("type"),s=t.data("name"),o=t.data("version"),u=jQuery("#backup_confirm").is(":checked")?1:0,a,f=e("div.jr-page-spinner"),l=e("<div>").html(jreviews.__t("UPDATER_PACKAGE_TRANSFERING")).append('<span class="jrLoadingSmall">');if(!n.find("input#update_overwrite").is(":checked"))e.jrAlert(jreviews.__t("UPDATER_INSTALL_CONFIRM"));else{var c=new e.Deferred,h=new e.Deferred,p=new e.Deferred;c.done(function(){var n={type:i,name:s,version:o,backup:u},r=jreviews.dispatch({method:"get",type:"json",controller:"admin/admin_updater",action:"_installPackage",data:n});r.done(function(n){var r=e("<p>"+jreviews.__t(n.str)+"</p>");l.html(r);if(n.success===!0){r.css("color","green");if(i=="addon")t.val(jreviews.__t("UPDATER_INSTALLED")).css("color","red").attr("disabled","disabled");else if(i=="component"){var o="index.php?option=com_"+s+"&format=raw&update=1";f.show();h.resolve(o)}}else r.css("color","red")})});h.done(function(n){var r=e.ajax({type:"GET",url:s2AjaxUriBase+"administrator/"+n,dataType:"json"});f.hide();r.done(function(n){if(n.success)if(s=="s2framework"){l.append(e("<p>"+jreviews.__t("UPDATER_COMPONENT_SUCCESS")+"<p>").css("color","green")).append(e("<p>"+jreviews.__t("UPDATER_RELOAD_PAGE")+"</p>").css({"font-weight":"bold","font-size":"13px","text-decoration":"underline"}));t.val(jreviews.__t("UPDATER_INSTALLED")).css("color","red").attr("disabled","disabled")}else{l.append(e("<p>"+jreviews.__t("UPDATER_PACKAGE_EXTRACT_OK")+"<p>").css("color","green"));var r="index.php?option=com_"+s+"&url=install/index/task:upgrade&format=raw";f.show();p.resolve(r)}else l.append(e("<p>"+jreviews.__t("UPDATER_PACKAGE_EXTRACT_FAIL")+"<p>").css("color","red"))})});p.done(function(n){var r=e.ajax({type:"GET",url:s2AjaxUriBase+"administrator/"+n,dataType:"json"});r.done(function(n){f.hide();if(n.success){l.append(e("<p>"+jreviews.__t("UPDATER_COMPONENT_SUCCESS")+"<p>").css("color","green")).append(e("<p>"+jreviews.__t("UPDATER_RELOAD_PAGE")+"</p>").css({"font-weight":"bold","font-size":"13px","text-decoration":"underline"}));t.val(jreviews.__t("UPDATER_INSTALLED")).css("color","red").attr("disabled","disabled")}else l.append(e("<p>"+jreviews.__t(n.str)+"</p>").css("color","red"))})});var d={},v=function(){c.resolve()};e.jrDialog(l,{title:r,buttons:d,open:v,width:"600px"})}},removeAddon:function(t,n){var r=t.data("name"),i={name:r},s=new e.Deferred;s.done(function(e){var n=jreviews.dispatch({method:"get",controller:"admin/admin_updater",action:"_removeAddon",data:i});n.done(function(n){if(n.success===!0){e.dialog("option","buttons",[]);e.html(jreviews.__t("UPDATER_ADDON_REMOVED_OK"));t.val(jreviews.__t("UDPATER_REMOVED")).css("color","red").attr("disabled","disabled")}else{e.dialog("option","buttons",[]);e.html(jreviews.__t("UPDATER_ADDON_REMOVED_FAIL"))}})});var o={};o[jreviews.__t("DELETE")]=function(){s.resolve(e(this))};o[jreviews.__t("CANCEL")]=function(){e(this).dialog("close")};e.jrDialog(jreviews.__t("UPDATER_ADDON_REMOVE_CONFIRM"),{buttons:o,title:"",width:"640px"});var u=e(".ui-dialog-buttonpane");u.find("button:contains("+jreviews.__t("DELETE")+")").addClass("jrButton").prepend('<span class="jrIconDelete"></span>');u.find("button:contains("+jreviews.__t("CANCEL")+")").addClass("jrButton").prepend('<span class="jrIconCancel"></span>')}};jreviews.license={init:function(){var t=jrPage;t.on("click","button#jr-license-submit",function(t){t.preventDefault();var n=e(this),r=n.closest("form");e("input#jr-license-number").val()===""?e.jrAlert(jreviews.__t("LICENSE_VALIDATE")):r.submit()})}};jreviews.config={init:function(){var t=jrPage;t.on("click","div.jr-configuration button.jr-twitter-setup",function(t){t.preventDefault();jreviews.config.twitterSetup(e(this))});t.on("change","div.jr-configuration select#jr-site-theme",function(){t.find("div.jr-configuration #jr-site-theme-desc").html(t.find("#theme-"+this.value).html())});t.on("change","div.jr-configuration select#jr-mobile-theme",function(){t.find("div.jr-configuration #jr-mobile-theme-desc").html(t.find("#theme-"+this.value).html())});t.find("div.jr-configuration select#rss_image").val()===""&&t.find("img#jr-feed-img").hide();t.on("change","div.jr-configuration select#rss_image",function(){var n=e(this);img=t.find("img#jr-feed-img"),selected=n.val();selected!==""?img.attr("src",(jreviews.cms==1?"../images/stories/":"../images/")+selected).show():img.hide()})},twitterSetup:function(t){var n=t.html(),r=jreviews.dispatch({method:"get",type:"html",controller:"admin/admin_twitter",action:"form"});r.done(function(t){var r={};r[jreviews.__t("SAVE")]=function(){var t=e(this),n=t.find("form");jreviews.dispatch({form:n}).done(function(){t.dialog("close")})};r[jreviews.__t("CANCEL")]=function(){e(this).dialog("close")};var i=e.jrDialog(t,{title:n,buttons:r,width:"600px"}),s=e(".ui-dialog-buttonpane");s.find("button:contains("+jreviews.__t("SAVE")+")").addClass("jrButton jrGreen").prepend('<span class="jrIconSave"></span>');s.find("button:contains("+jreviews.__t("CANCEL")+")").addClass("jrButton").prepend('<span class="jrIconCancel"></span>')})}};jreviews.category={edit:function(t,n){var r=t.data("id")||0,i=t.closest("form"),s=r>0?"edit":"create",o=t.html(),u=jreviews.dispatch({method:"get",type:"html",controller:"admin/categories",action:s,data:{id:r}});u.done(function(r){var i={};i[jreviews.__t("SAVE")]=function(){var r=e(this),i=r.find("form"),o=e(".ui-dialog-buttonpane"),u=o.find(".jr-validation"),a=jreviews.dispatch({form:i,data:{"data[task]":s}});u=u.length?u:e('<div class="jr-validation jrError">');u.hide();a.done(function(e){if(e.success){r.dialog("close");e.isNew?jreviews.category.save(t,n,i):t.closest("div.jr-layout-outer").trigger("update")}else if(e.str.length){o.prepend(u.html(jreviews.__t(e.str)));u.fadeIn()}})};var u=s==="edit"?500:800;i[jreviews.__t("CANCEL")]=function(){e(this).dialog("close")};var a=e.jrDialog(r,{title:o,buttons:i,width:u+"px"}),f=e(".ui-dialog-buttonpane");f.find("button:contains("+jreviews.__t("SAVE")+")").addClass("jrButton jrGreen").prepend('<span class="jrIconSave"></span>');f.find("button:contains("+jreviews.__t("CANCEL")+")").addClass("jrButton").prepend('<span class="jrIconCancel"></span>')})},save:function(t,n,r){r=r||t.closest("form");var i=r.find("div.jr-validation");i.hide();var s=jreviews.dispatch({form:r});s.done(function(t){t.success?n.html(t.html).fadeIn("fast").promise().done(function(){e.each(t.id,function(e,t){var r=n.find('div.jr-layout-outer[data-id="'+t+'"]');jreviews.tools.flashRow(r)})}):t.str.length&&i.html(jreviews.__t(t.str)).show().delay(5e3).fadeOut()})}};jreviews.directory={edit:function(t,n){var r=t.data("id")||0,i=t.closest("form");if(Number(r)===0){jreviews.directory.save(t,n,i);return!1}var s=jreviews.dispatch({method:"get",type:"html",controller:"admin/directories",action:"edit",data:{id:r}});s.done(function(n){var r={};r[jreviews.__t("SAVE")]=function(){var n=e(this),r=n.find("form"),i=jreviews.dispatch({form:r}),s=e(".ui-dialog-buttonpane"),o=s.find(".jr-validation");o=o.length?o:e('<div class="jr-validation jrError">');o.hide();i.done(function(e){if(e.success){n.dialog("close");t.closest("div.jr-layout-outer").trigger("update")}else if(e.str.length){s.prepend(o.html(jreviews.__t(e.str)));o.fadeIn()}})};r[jreviews.__t("CANCEL")]=function(){e(this).dialog("close")};var i=e.jrDialog(n,{buttons:r,width:"700px"});jreviews.field.control_setup(i.find("form"));var s=e(".ui-dialog-buttonpane");s.find("button:contains("+jreviews.__t("SAVE")+")").addClass("jrButton jrGreen").prepend('<span class="jrIconSave"></span>');s.find("button:contains("+jreviews.__t("CANCEL")+")").addClass("jrButton").prepend('<span class="jrIconCancel"></span>')})},save:function(e,t,n){n=n||e.closest("form");var r=n.find("div.jr-validation");r.hide();var i=jreviews.dispatch({form:n});i.done(function(e){e.success?t.html(e.html).fadeIn("fast").promise().done(function(){var n=t.find('div.jr-layout-outer[data-id="'+e.id+'"]');n.jrScrollTo({offset:-200,duration:500});jreviews.tools.flashRow(n)}):e.str.length&&r.html(jreviews.__t(e.str)).show().delay(5e3).fadeOut()})}};jreviews.field={init:function(){var t=jrPage;t.on("click","button.jr-edit-fieldoptions",function(n){n.preventDefault();jreviews.fieldoption.browse(e(this),t)});t.on("click","button.jr-field-length",function(n){n.preventDefault();jreviews.field.changeLength(e(this),t)})},edit:function(t,n){var r=t.data("id"),i=t.data("location")||"",s=jreviews.dispatch({method:"get",type:"html",controller:"admin/fields",action:"edit",data:{id:r,location:i}});s.done(function(r){var i=n.children("div").eq(0),s=e("<div>");s.insertBefore(i);jrAdmin.data("prevPage.fields",i.detach());s.html(r).jrScrollTo();var o=s.find("form"),u=Number(o.data("id")),a=o.data("location");s.on("click","button.jr-save, button.jr-apply",function(n){n.preventDefault();e(this).hasClass("jr-apply")&&t.data("apply",!0);jreviews.field.save(t,o,s)});e(".jr-multiselect").multiselect({minWidth:"200",height:"auto",selectedList:3});var f=o.data("jr-box-varchar"),l=["jr-box-varchar","jr-box-banner","jr-box-required","jr-box-controlfield","jr-box-description","jr-box-listsort","jr-box-click2add","jr-box-click2search","jr-box-submitaccess","jr-box-relatedlistings"],c={"default":["jr-box-varchar","jr-box-banner","jr-box-relatedlistings"],banner:["jr-box-varchar","jr-box-required","jr-box-controlfield","jr-box-description","jr-box-listsort","jr-box-click2add","jr-box-click2search","jr-box-submitaccess","jr-box-relatedlistings"],checkboxes:["jr-box-click2add","jr-box-listsort","jr-box-banner","jr-box-relatedlistings"],select:["jr-box-banner","jr-box-relatedlistings"],radiobuttons:["jr-box-click2add","jr-box-banner","jr-box-relatedlistings"],selectmultiple:["jr-box-listsort","jr-box-banner","jr-box-relatedlistings"],email:["jr-box-click2search","jr-box-click2add","jr-box-banner","jr-box-relatedlistings"],website:["jr-box-varchar","jr-box-click2search","jr-box-click2add","jr-box-banner","jr-box-relatedlistings"],integer:["jr-box-varchar","jr-box-click2add","jr-box-banner","jr-box-relatedlistings"],date:["jr-box-varchar","jr-box-click2add","jr-box-banner","jr-box-relatedlistings"],decimal:["jr-box-varchar","jr-box-click2add","jr-box-banner","jr-box-relatedlistings"],textarea:["jr-box-varchar","jr-box-click2add","jr-box-banner","jr-box-relatedlistings"],text:["jr-box-click2add","jr-box-banner","jr-box-relatedlistings"],code:["jr-box-varchar","jr-box-click2add","jr-box-banner","jr-box-relatedlistings"],relatedlisting:["jr-box-click2search","jr-box-click2add","jr-box-banner"]};if(f===!1){c.checkboxes.push("jr-box-varchar");c.select.push("jr-box-varchar");c.radiobuttons.push("jr-box-varchar");c.selectmultiple.push("jr-box-varchar")}s.find("#jr-autocomplete-settings").css("display","none");s.find("#jr-type").on("change",function(){var t=e(this).val();t=t===""?"default":t;s.find("#jr-code-description").toggle(t==="code");var n=c[t];e.each(l,function(t,r){var i=e.inArray(r,n)===-1,o=s.find("#"+r);o.length&&(i?o.toggle(!0).find("input,textarea,select").removeAttr("disabled"):o.toggle(!1).find("input,textarea,select").attr("disabled","disabled"))});var r=e.inArray(t,["select","selectmultiple"])>-1;s.find("#jr-autocomplete").toggle(r).children(":input").removeAttr("disabled");s.find("#jr-autocomplete-settings").toggle(r);var i=s.find("#jr-advancedoptions"),o=s.find("#jr-box-advancedoptions");if(t!=="default"&&t!=="banner"){var f=jreviews.dispatch({method:"get",type:"html",controller:"admin/fields",action:"checkType",data:{id:u,type:t,location:a}});f.done(function(e){i.html(e);o.toggle(e!=="")})}else{i.html("");o.hide()}var h=jreviews.dispatch({method:"get",type:"text",controller:"admin/fieldoptions",action:"_controlledByCheck",data:{id:u}});h.done(function(t){var n=s.find("#jr-fieldoption-count");n.data("count",Number(t));if(Number(t)>0){n.html(t).closest("div").fadeIn("slow");s.one("click","input#control_field",function(){e.jrAlert(__a("You need to remove the FieldOption relationships first",!0))})}else n.fadeOut().closest("div").hide()})}).trigger("change")})},save:function(e,t,n){var r=e.closest("div.jr-layout-outer"),i=t.find(".jr-buttons"),s=e.data("apply")||!1,o=n.find("div.jr-validation"),u={},a=jrAdmin.data("prevPage.fields");i.find("button").attr("disabled","disabled");o.hide();u.apply=s;var f=jreviews.dispatch({form:t,data:u});f.done(function(t){if(t.success)if(s){jreviews.tools.apply();e.data("apply",!1)}else t.isNew?n.fadeOut().promise().done(function(){a.html(t.html);var e=a.find('div.jr-layout-outer[data-id="'+t.id+'"]');a.insertAfter(n).fadeIn("fast").promise().done(function(){e.jrScrollTo({offset:-200,duration:500});jreviews.tools.flashRow(e)});n.remove()}):n.fadeOut("fast").promise().done(function(){a.insertAfter(n).fadeIn("fast").promise().done(function(){r.trigger("update");r.jrScrollTo({offset:-200,duration:500})});n.remove()});else t.str.length&&o.html(jreviews.__t(t.str)).show()});f.always(function(){t.find("button").removeAttr("disabled")})},control_setup:function(t){var n={field_id:"",field_search:"jr-control-field-search",value_search:"jr-control-value-search",value_div:"jr-control-value-div",value_option:"jr-control-value-option",model:"FieldOption",multipleValues:!1},r=t.find("."+n.field_search),i=t.find("."+n.value_search),s=t.find("."+n.value_div),o=t.data("location")||t.find("input.jr-field-location").val(),u=t.data("fieldid");n.model=t.data("model")||n.model;r.val()===""&&i.attr("disabled","disabled");r.data("old_val",r.val());s.on("change addcheckbox","input",function(){var t=e(this);if(t.not(":checked")){i.removeData(t.val());t.closest("label").remove()}s.toggle(s.find("input:checked").length?!0:!1)}).trigger("change");r.on("blur",function(){var t=e(this).val();(t===""||t!==r.data("old_val"))&&s.html("").hide();t===""?i.attr("disabled","disabled"):i.removeAttr("disabled");r.data("old_val",r.val())}).autocomplete({minLength:1,source:function(e,t){if(r.data("cache."+e.term))return t(r.data("cache."+e.term));var n={"data[limit]":12,"data[field]":e.term,"data[fieldid]":u,"data[location]":o},i=jreviews.dispatch({method:"get",type:"json",controller:"admin/admin_control_fields",action:"_loadFields",data:n});i.done(function(n){r.data("cache."+e.term,n);t(n)})},select:function(e,t){r.data("fieldid",t.item.id);i.val("");t.item.id!==""?i.removeAttr("disabled").focus():i.attr("disabled","disabled");(t.item.value===""||t.item.value!==r.data("old_val"))&&s.html("").hide()}});i.autocomplete({minLength:1,source:function(t,n){var o=s.find(":input:checked").map(function(e,t){return this.value});if(i.data("cache."+t.term)){var u=i.data("cache."+t.term),a=[];e(u).each(function(t,n){n!==undefined&&e.inArray(n.value,o)===-1&&a.push(u[t])});return n(a)}var f={"data[limit]":12,"data[field_id]":r.data("fieldid"),"data[value]":t.term},l=jreviews.dispatch({method:"get",type:"json",controller:"admin/admin_control_fields",action:"_loadValues",data:f});l.done(function(r){i.data("cache."+t.term,r
);var s=[];e(r).each(function(t,n){n!==undefined&&e.inArray(n.value,o)===-1&&s.push(r[t])});n(s)})},search:function(e,t){if(i.data("field_id")==="")return!1},select:function(t,r){if(r.item.value!==""){var o={"class":n.value_option+"-"+r.item.value,name:"data["+n.model+"][control_value][]",value:r.item.value},u=e('<input type="checkbox" checked="checked" value="'+r.item.value+'" />').attr(o);u.click(function(){i.removeData(r.item.value)});var a=e('<label for="'+n.value_option+"-"+r.item.value+'" />').css("text-align","left");a.append(u).append("<span>"+r.item.label+"</span>");s.show().append(a)}i.val("").focus();return!1}});e(".ui-autocomplete").css("white-space","nowrap")},changeLength:function(t,n){var r=t.data("id"),i=t.closest("form"),s=jreviews.dispatch({method:"get",type:"html",controller:"admin/fields",action:"_changeFieldLength",data:{id:r,task:"form"}});s.done(function(t){var r={};r[jreviews.__t("SAVE")]=function(){var t=e(this),r=t.find("form"),i=s.find(".jr-validation");i=i.length?i:e('<div class="jr-validation jrError">');var o=jreviews.dispatch({form:r});o.done(function(e){if(e.success){t.dialog("close");n.find("#max-length-value").html(e.maxlength)}else if(e.str.length){s.prepend(i.html(jreviews.__t(e.str)));i.fadeIn()}})};r[jreviews.__t("CANCEL")]=function(){e(this).dialog("close")};var i=e.jrDialog(t,{buttons:r,width:"800"}),s=e(".ui-dialog-buttonpane");s.find("button:contains("+jreviews.__t("SAVE")+")").addClass("jrButton jrGreen").prepend('<span class="jrIconSave"></span>');s.find("button:contains("+jreviews.__t("CANCEL")+")").addClass("jrButton").prepend('<span class="jrIconCancel"></span>')})}};jreviews.fieldoption={browse:function(t,n){var r=t.data("id"),i=jreviews.dispatch({method:"get",type:"html",controller:"admin/fieldoptions",action:"index",data:{id:r}}),s=new e.Deferred;s.done(function(t,n){var r=jreviews.dispatch({method:"get",type:"text",controller:"admin/fields",action:"_controlledByCheck",data:{id:n}});r.done(function(n){t.find("#control-field-check").toggle(Number(n)>0);Number(n)>0&&t.find("#control_field_new").one("click",function(){e.jrAlert("You need to remove the Field relation first")})})});i.done(function(t){var i=jrPage.children("div").eq(0),o=e("<div>");jreviews.field.prevPage=i;o.insertBefore(i);jrAdmin.data("prevPage.fieldoptions",i.detach());o.html(t);o.on("click","button.jr-clear",function(t){t.preventDefault();var n=e(this).closest("form");n.find("input[type=text]").each(function(){e(this).val("")});n.find("div.jr-control-value-div").html("").hide()});s.resolve(n,r)})},edit:function(t,n){var r=t.data("id")||0,i=t.closest("form");if(r===0){jreviews.fieldoption.save(t,n,i);return!1}var s=jreviews.dispatch({method:"get",type:"html",controller:"admin/fieldoptions",action:"edit",data:{id:r}});s.done(function(n){var r={};r[jreviews.__t("SAVE")]=function(){var n=e(this),r=n.find("form"),i=e(".ui-dialog-buttonpane"),s=i.find(".jr-validation"),o=jreviews.dispatch({form:r});s=s.length?s:e('<div class="jr-validation jrError">');o.done(function(e){if(e.success){n.dialog("close");t.closest("div.jr-layout-outer").trigger("update")}else if(e.str.length){i.prepend(s.html(jreviews.__t(e.str)));s.fadeIn()}})};r[jreviews.__t("CANCEL")]=function(){e(this).dialog("close")};var i=e.jrDialog(n,{buttons:r,width:"800px"});jreviews.field.control_setup(i.find("form"));var s=e(".ui-dialog-buttonpane");s.find("button:contains("+jreviews.__t("SAVE")+")").addClass("jrButton jrGreen").prepend('<span class="jrIconSave"></span>');s.find("button:contains("+jreviews.__t("CANCEL")+")").addClass("jrButton").prepend('<span class="jrIconCancel"></span>')})},save:function(e,t,n){n=n||e.closest("form");var r=n.find("div.jr-validation");r.hide();var i=jreviews.dispatch({form:n});i.done(function(e){if(e.success){var i=n.find(".jr-control-field-search").val(),s=n.find(".jr-control-value-div").html(),o=n.find(".jr-control-field-search").data("fieldid");t.html(e.html).fadeIn("fast").promise().done(function(){var n=t.find('div.jr-layout-outer[data-id="'+e.id+'"]');t.find(".jr-control-field-search").val(i);t.find(".jr-control-value-div").html(s);i!==""&&t.find(".jr-control-field-search").data("fieldid",o);if(n.length){n.jrScrollTo({offset:-200,duration:500});jreviews.tools.flashRow(n)}})}else e.str.length&&r.html(jreviews.__t(e.str)).show().delay(5e3).fadeOut()})}};jreviews.group={init:function(){var t=jrPage;t.on("click","button.jr-clear",function(t){t.preventDefault();var n=e(this).closest("form");n.find("input[type=text]").each(function(){e(this).val("")});n.find("div.jr-control-value-div").html("").hide()});t.on("grouplocation change","form select#jr-group-type",function(n){n.preventDefault();e(this).next("input").val(e(this).val());t.find("form span#jr-group-type-label").html(e(this).find("option:selected").text());t.find("form input#jr-group-type-hidden").val(e(this).find("option:selected").val())}).trigger("change")},changeLocation:function(){jrPage.find("form select#jr-group-type").trigger("grouplocation")},edit:function(t,n){var r=t.data("id")||0,i=t.closest("form");if(Number(r)===0){jreviews.group.save(t,n,i);return!1}var s=jreviews.dispatch({method:"get",type:"html",controller:"admin/groups",action:"edit",data:{id:r}});s.done(function(n){var r={};r[jreviews.__t("SAVE")]=function(){var n=e(this),r=n.find("form"),i=jreviews.dispatch({form:r}),s=e(".ui-dialog-buttonpane"),o=s.find(".jr-validation");o=o.length?o:e('<div class="jr-validation jrError">');o.hide();i.done(function(e){if(e.success){n.dialog("close");t.closest("div.jr-layout-outer").trigger("update")}else if(e.str.length){s.prepend(o.html(jreviews.__t(e.str)));o.fadeIn()}})};r[jreviews.__t("CANCEL")]=function(){e(this).dialog("close")};var i=e.jrDialog(n,{buttons:r,width:"960px"});jreviews.field.control_setup(i.find("form"));var s=e(".ui-dialog-buttonpane");s.find("button:contains("+jreviews.__t("SAVE")+")").addClass("jrButton jrGreen").prepend('<span class="jrIconSave"></span>');s.find("button:contains("+jreviews.__t("CANCEL")+")").addClass("jrButton").prepend('<span class="jrIconCancel"></span>')})},save:function(e,t,n){n=n||e.closest("form");var r=n.find("div.jr-validation");r.hide();var i=jreviews.dispatch({form:n});i.done(function(e){e.success?t.html(e.html).fadeIn("fast").promise().done(function(){var n=t.find('div.jr-layout-outer[data-id="'+e.id+'"]');n.jrScrollTo({offset:-200,duration:500});jreviews.tools.flashRow(n)}):e.str.length&&r.html(jreviews.__t(e.str)).show().delay(5e3).fadeOut()})}};jreviews.media={init:function(){var e=jrPage,t=e.find("div.jr-media-upload");if(t.length){var n=t.find("form#jr-form-media-upload"),r=n.data("file-validation");jreviewsMedia.initUploader("jr-media-uploader",{fileValidation:r})}},browse:function(){var t=jrPage;t.on("click","a.jr-media-filter, button.jr-media-filter",function(n){n.preventDefault();var r=e(this),i=r.data("listing-id")||0,s=r.data("review-id")||0,o=r.data("user-id")||0,u=r.data("extension")||"com_content",a;a={listing_id:i,review_id:s,user_id:o,extension:u};var f=t.children("div").eq(0),l=e("<div>");l.insertBefore(f);jrAdmin.data("prevPage.admin_media",f.detach());jreviews.menu.load("admin_media","browse",a)});t.on("click","button.jr-media-main",function(n){n.preventDefault();jreviews.media.setMain(e(this),t)})},download:function(t,n,r){e("#jrDownload"+t).remove();var i=e('<iframe id="jrDownload'+t+'" style="display:none;"></iframe>');i.attr("src",s2AjaxUri+"&url=admin_media/download&m="+t+"&"+n+"=1&"+r+"=1").appendTo("body")},edit:function(t,n){var r=t.data("id")||0,i="",s=jreviews.dispatch({method:"get",type:"html",controller:"admin/admin_media",action:"edit",data:{id:r}});s.done(function(n){var r={};r[jreviews.__t("SAVE")]=function(){var n=e(this),r=n.find("form"),i=jreviews.dispatch({form:r});i.done(function(e){if(e.success){n.dialog("close");t.closest("div.jr-layout-outer").trigger("update")}if(e.str.length){n.dialog("option","buttons",[]);n.html(jreviews.__t(e.str))}})};r[jreviews.__t("CANCEL")]=function(){e(this).dialog("close");e(this).find("#jr-video-player").trigger("jrVideoDestroy");e(this).find("#jr-audio-player").remove()};var s=function(){e(this).find("#jr-video-player").trigger("jrVideoDestroy");e(this).find("#jr-audio-player").remove()},o=function(){var t=e(this),n=t.find("div.jr-video-gallery"),r=t.find("#jr-audio-player"),i=t.find(".jr-thumbnails");i.length&&i.find(".jr-thumb-del").on("click",function(){var t=e(this);if(t.data("delete")==1){t.data("delete",0);var n={id:t.data("id"),size:t.data("size")},r=jreviews.dispatch({method:"get",type:"json",controller:"admin/admin_media",action:"_deleteThumb",data:n});r.done(function(e){e.success&&t.fadeOut(500)})}}).on("mouseenter",function(){var t=e(this),n=e('<span class="jrIconDelete jrIconOnly">');e(this).data("delete",1).data("contents",e(this).html()).css("width",e(this).width()+"px").css("height",e(this).height()+"px").html(n)}).on("mouseleave",function(){e(this).data("delete",0).html(e(this).data("contents"))});n.length&&jreviewsMedia.videoGallery.init();r.length&&jreviewsMedia.audioPlayer();jreviews.userAutocomplete(t.find("form"))},u=e.jrDialog(n,{title:i,open:o,close:s,buttons:r,width:"800px"}),a=e(".ui-dialog-buttonpane");a.find("button:contains("+jreviews.__t("SAVE")+")").addClass("jrButton jrGreen").prepend('<span class="jrIconSave"></span>');a.find("button:contains("+jreviews.__t("CANCEL")+")").addClass("jrButton").prepend('<span class="jrIconCancel"></span>')})},setMain:function(t,n){var r=t.find("span").eq(0),i=t.data("listing-id"),s=t.data("id"),o=t.data("states"),u={listing_id:i,media_id:s};t.attr("disabled","disabled");var a=jreviews.dispatch({method:"get",type:"json",controller:"admin/admin_media",action:"setMainMedia",data:u});a.done(function(i){if(i.success===!0){var s=function(){n.find("button.jr-media-main").not(t).removeAttr("disabled").each(function(){e(this).find("span").eq(0).attr("class",o[0])})};e.when(s()).done(function(){r.attr("class",o[1])})}})}};jreviews.listing={browse:function(){var t=jrPage;t.on("click","div.jr-listings-list button.jr-feature",function(t){t.preventDefault();jreviews.listing.feature(e(this))});t.on("click","div.jr-listings-list button.jr-claim",function(t){t.preventDefault();jreviews.listing.claimStatus(e(this))});t.on("click","div.jr-listings-list a.jr-access",function(t){t.preventDefault();jreviews.listing.access(e(this))})},feature:function(e){var t=e.data("id"),n=e.find("span").eq(0),r=e.data("states"),i=jreviews.dispatch({method:"get",type:"json",controller:"admin/admin_listings",action:"_feature",data:{id:t}});i.done(function(e){e.success&&n.attr("class",r[e.state])})},claimStatus:function(t){var n=t.find("span").eq(1),r=t.data("id"),i=t.data("user-id"),s=t.data("states"),o=t.data("referrer"),u=t.closest("div.jr-layout-outer"),a=[];a=e.map(s,function(e){return e}).join(" ");var f=jreviews.dispatch({method:"get",type:"html",controller:"admin/admin_claims",action:"edit",data:{id:r,user_id:i,referrer:o}});f.done(function(r){var i={};i[jreviews.__t("SAVE")]=function(){var n=e(this),r=n.find("form"),i=jreviews.dispatch({form:r});i.done(function(e){n.dialog("close");t.removeClass(a);r.find('select[name="data[Claim][approved]"]').val()==1&&t.addClass(s[e.state]);u.trigger("update")})};i[jreviews.__t("CANCEL")]=function(){e(this).dialog("close")};var o=e.jrDialog(r,{buttons:i,title:n.html(),width:"640px"});jreviews.userAutocomplete(o.find("form"));var f=e(".ui-dialog-buttonpane");f.find("button:contains("+jreviews.__t("SAVE")+")").addClass("jrButton jrGreen").prepend('<span class="jrIconSave"></span>');f.find("button:contains("+jreviews.__t("CANCEL")+")").addClass("jrButton").prepend('<span class="jrIconCancel"></span>')})},access:function(e){var t=e.data("id"),n=e.data("states"),r=e.find("span").eq(0),i=e.data("lang"),s=jreviews.dispatch({method:"get",type:"json",controller:"admin/admin_listings",action:"_changeAccess",data:{id:t}});s.done(function(e){if(e.success){r.attr("class",n[jreviews.cms==1?e.state-1:e.state]);r.html(i[jreviews.cms==1?e.state-1:e.state])}})},edit:function(t,n){var r=t.data("id"),i=t.data("referrer");i=i||"browse";var s=e(".jr-page-spinner").show(),o=jreviews.dispatch({method:"get",type:"html",controller:"admin/admin_listings",action:"edit",data:{id:r,referrer:i}});o.done(function(r){var i=n.children("div").eq(0),o=e("<div>");o.insertBefore(i);jrAdmin.data("prevPage.admin_listings",i.detach());o.html(r).find(".jr-tabs").tabs();var u=o.find("form"),a=u.find("#listing_id").val(),f=u.find("button.jr-save"),l=u.find("button.jr-new");u.find(".jr-title").focus();u.find(".jr-wysiwyg-editor").tinyMCE();f.on("click",function(e){e.preventDefault();jreviews.listing.save(t,u,o)});l.on("click",function(n){n.preventDefault();u.append(e('<input name="data[saveAsNew]" value="1">')).data("isNew",!0);jreviews.listing.save(t,u,o)});jreviews.userAutocomplete(u);var c=u.jreviewsFields({entry_id:a,value:!1,page_setup:!0});c&&c.done(function(){i.fadeOut("fast").promise().done(function(){o.fadeIn("fast");o.jrScrollTo();s.hide()})})})},save:function(t,n,r){var i=t.closest("div.jr-layout-outer"),s=n.find(".jr-buttons"),o=n.find(".jr-wysiwyg-editor"),u=n.find(".jr-validation"),a=0,f=[],l,c,h=jrAdmin.data("prevPage.admin_listings");e("select[id^=cat_id]").each(function(){var t=e(this).val();t>0&&f.push(e(this))});a=f.length;if(a===1)n.find("#category").val(f[0].find("option:selected").text().replace(/(- )+/,""));else if(a>1){n.find("#category").val(f[a-1].find("option:selected").text().replace(/(- )+/,""));n.find("#parent_category").val(f[a-2].find("option:selected").text().replace(/(- )+/,""))}try{o.RemoveTinyMCE()}catch(p){}n.jrSetValidFields().join(",");s.find("button").attr("disabled","disabled");u.hide();var d=jreviews.dispatch({form:n});d.done(function(e){if(e.success===!0)if(e.isNew){h.remove();r.html(e.html);i=r.find('div.jr-layout-outer[data-id="'+e.id+'"]');i.jrScrollTo({offset:-200,duration:500});jreviews.tools.flashRow(i)}else r.fadeOut("fast").promise().done(function(){h.insertAfter(r).fadeIn("fast").promise().done(function(){i.trigger("update");i.jrScrollTo({offset:-200,duration:500})});r.remove()});else if(e.str.length){u.html(jreviews.__t(e.str)).show();o.tinyMCE()}});d.always(function(){n.find("button").removeAttr("disabled")})}};jreviews.review={browse:function(){var t=jrPage;t.on("click","div.jr-reviews-list button.jr-review-type",function(t){t.preventDefault();jreviews.review.reviewType(e(this))});t.on("click","div.jr-reviews-list button.jr-owner-reply",function(t){t.preventDefault();jreviews.review.ownerReply(e(this))});t.on("click",".jr-review-filter, .jr-media-filter",function(t){t.preventDefault();var n=e(this),r=n.data("listing-id")||0,i=n.data("review-type")||"",s=n.data("user-id")||0,o=n.data("extension")||"com_content",u=n.data("filter")||"",a=n.data("referrer")||"",f;f={listing_id:r,type:i,user_id:s,extension:o,filter_order:u,referrer:a};jreviews.menu.load("admin_reviews","browse",f)})},edit:function(t,n){var r=t.data("id"),i=t.data("referrer");i=i||"browse";var s=e(".jr-page-spinner").show(),o=jreviews.dispatch({method:"get",type:"html",controller:"admin/admin_reviews",action:"edit",data:{id:r,referrer:i}});o.done(function(i){var o=n.children("div").eq(0),u=e("<div>");u.insertBefore(o);jrAdmin.data("prevPage.admin_reviews",o.detach());u.html(i);var a=u.find("form"),f=a.find("button.jr-save"),l=a.find("button.jr-cancel");a.find(".jr-title").focus();jreviews.review.starRating(a);f.on("click",function(e){e.preventDefault();jreviews.review.save(t,a,u)});jreviews.userAutocomplete(a);var c=a.jreviewsFields({fieldLocation:"Review",entry_id:r,value:!1,page_setup:!0});c&&c.done(function(){o.fadeOut("fast").promise().done(function(){u.fadeIn("fast");u.jrScrollTo();s.hide()})})})},save:function(t,n,r){var i=t.closest("div.jr-layout-outer"),s=n.find(".jr-buttons"),o=n.find(".jr-validation"),u=jrAdmin.data("prevPage.admin_reviews");n.jrSetValidFields().join(",");s.find("button").attr("disabled","disabled");o.hide();var a=jreviews.dispatch({form:n});a.done(function(t){t.success?r.fadeOut("fast").promise().done(function(){if(t.html){var n=e(t.html);i.html(n.html())}u.insertAfter(r).fadeIn("fast").promise().done(function(){i.trigger("update");i.jrScrollTo({offset:-200,duration:500})});r.remove()}):t.str.length&&o.html(jreviews.__t(t.str))});a.always(function(){n.find("button").removeAttr("disabled")})},reviewType:function(t){var n=t.data("id"),r=t.find("span").eq(0),i=t.data("states"),s=t.data("lang"),o=jreviews.dispatch({method:"get",type:"json",controller:"admin/admin_reviews",action:"changeReviewType",data:{id:n}});o.done(function(t){t.success?r.attr("class",i[t.state]):t.msg in s?e.jrAlert(s[t.msg]):t.str.length&&e.jrAlert(jreviews.__t(t.str))})},ownerReply:function(t){var n=t.find("span").eq(1),r=t.data("id"),i=t.data("states"),s=t.data("referrer"),o=[];o=e.map(i,function(e){return e}).join(" ");var u=jreviews.dispatch({method:"get",type:"html",controller:"admin/admin_owner_replies",action:"edit",data:{id:r,referrer:s}});u.done(function(r){var s={};s[jreviews.__t("SAVE")]=function(){var n=e(this),r=n.find("form"),s=jreviews.dispatch({form:r});s.done(function(e){n.dialog("close");t.removeClass(o);r.find('textarea[name="data[OwnerReply][owner_reply_text]"]').val()!==""&&t.addClass(i[e.state]);jreviews.tools.flashRow(t.closest(".jr-layout-outer"))})};s[jreviews.__t("CANCEL")]=function(){e(this).dialog("close")};e.jrDialog(r,{buttons:s,title:n.html(),width:"640px"});var u=e(".ui-dialog-buttonpane");u.find("button:contains("+jreviews.__t("SAVE")+")").addClass("jrButton jrGreen").prepend('<span class="jrIconSave"></span>');u.find("button:contains("+jreviews.__t("CANCEL")+")").addClass("jrButton").prepend('<span class="jrIconCancel"></span>')})},starRating:function(t){t.find(".jr-rating-stars").each(function(){var t=e(this),n=t.data("selector"),r=t.data("inc"),i=e("<span></span>");if(n==="stars"){t.parent().next().append(i);var s=1/r;t.stars({split:s,captionEl:i})}})}};jreviews.listing_type={init:function(){var t=jrPage;t.on("click","button.jr-copy",function(n){n.preventDefault();var r=e(this),i=1,s=t.find("input[type=radio]:checked").val(),o=jreviews.dispatch({method:"get",controller:"admin/listing_types",action:"_copy",data:{id:s,copies:i}});o.done(function(n){if(n.success){t.find("div#jr-table").html(n.html);var r=t.find('div.jr-layout-outer[data-id="'+n.id+'"]');r.jrScrollTo({offset:-200,duration:500});jreviews.tools.flashRow(r)}else n.str.length&&e.jrAlert(jreviews.__t(n.str))})});t.on("click","button.jr-sync-ratings",function(t){t.preventDefault();var n=jreviews.dispatch({method:"get",type:"html",controller:"admin/listing_types",action:"refreshReviewRatings"});n.done(function(t){e.jrAlert(t)})})},edit:function(t,n){var r=t.data("id")||0,i=jreviews.dispatch({method:"get",type:"html",controller:"admin/listing_types",action:"edit",data:{id:r}});i.done(function(r){var i=n.children("div").eq(0),s=e("<div>");s.insertBefore(i);jrAdmin.data("prevPage.listing_types",i.detach());s.html(r).jrScrollTo();var o=s.find("form");s.on("click","button.jr-save, button.jr-apply",function(n){n.preventDefault();e(this).hasClass("jr-apply")&&t.data("apply",!0);jreviews.listing_type.save(t,o,s)});s.on("change",".jr-field-matches",function(){e(this).val()==="diff_field"?e(this).parents("div:eq(1)").next("div").slideDown():e(this).parents("div:eq(1)").next("div").slideUp()});s.find(".jr-tabs").tabs();s.find(".jr-field-matches").trigger("change");s.find(".jr-multiselect").multiselect({minWidth:200,height:"auto",selectedList:3});s.find(".multiselectGroup").multiselect({minWidth:300,height:"auto",selectedList:3});var u=s.find("div.jr-ratings"),a=e.trim(s.find("script#jr-rating-template").html()),f=s.find("input.global-cb");s.on("click","button.jr-add-rating",function(e){e.preventDefault();u.append(a).find("div.jr-layout").last().fadeIn()});u.on("click","button.jr-remove-rating",function(t){t.preventDefault();u.find("div.jr-layout").length>1&&e(this).closest("div.jr-layout").slideUp("fast").promise().done(function(){e(this).remove();u.find("input.jr-weights").trigger("sumWeights")})});u.on("click","input.jr-rating-required",function(t){var n=e(this).is(":checked");e(this).prev("input").val(n?1:0)});u.on("blur sumWeights","input.jr-weights",function(){var t=0,n=s.find("div.jr-sum-weights");u.find("input.jr-weights").each(function(){t+=Number(e(this).val())});n.html(t.toFixed(0));n.removeClass("jrRed jrGreen jrOrange").addClass("jrStatusLabel");var r=Number(n.html());r>100?n.addClass("jrRed"):r===100?n.addClass("jrGreen"):r>0&&r<100&&n.addClass("jrOrange")});u.find("input.jr-weights").trigger("sumWeights");s.on("click","input.global-cb",function(){jreviews.listing_type.processGlobals(e(this))});s.find("input.global-cb:checked").each(function(){jreviews.listing_type.processGlobals(e(this))})})},processGlobals:function(t){var n=t.closest("label").next(),r=n.find("input,select").eq(0),i;if(t.data("globalSetting")===undefined){i=e('<input type="hidden" value="-1" />').attr("name",r.attr("name"));t.data("globalSetting",i);n.after(i)}else i=t.data("globalSetting");var s=n.find("select");if(t.is(":checked")===!0){n.find("input,select,button").attr("disabled","disabled");if(s.length&&s.multiselect&&(s.hasClass("jr-multiselect")||s.hasClass("multiselectGroup"))){s.multiselect();s.multiselect("disable")}i.removeAttr("disabled")}else{n.find("input,select,button").removeAttr("disabled");if(s.length&&s.multiselect&&(s.hasClass("jr-multiselect")||s.hasClass("multiselectGroup"))){s.multiselect();s.multiselect("enable")}i.attr("disabled","disabled")}},save:function(e,t,n){var r=e.closest("div.jr-layout-outer"),i=n.find(".jr-toolbar button").attr("disabled","disabled"),s=e.data("id"),o=e.data("apply")||!1,u=n.find("div.jr-validation"),a=jrAdmin.data("prevPage.listing_types");u.hide();var f=jreviews.dispatch({form:t,data:{apply:o}});f.done(function(t){if(t.success===!0)if(o){jreviews.tools.apply();e.data("apply",!1)}else t.isNew?n.fadeOut().promise().done(function(){a.html(t.html);var e=a.find('div.jr-layout-outer[data-id="'+t.id+'"]');a.insertAfter(n).fadeIn("fast").promise().done(function(){e.jrScrollTo({offset:-200,duration:500});jreviews.tools.flashRow(e)});n.remove()}):n.fadeOut("fast").promise().done(function(){a.insertAfter(n).fadeIn("fast").promise().done(function(){r.trigger("update");r.jrScrollTo({offset:-200,duration:500})});n.remove()});else t.str.length&&u.html(jreviews.__t(t.str)).show()});f.always(function(){i.removeAttr("disabled")})}};jreviews.moderation={init:function(){var t=jrPage;t.on("click","div.jr-moderation button.jr-submit",function(t){t.preventDefault();jreviews.moderation.moderate(e(this))});t.on("change","div.jr-moderation select.jr-select-reply",function(t){t.preventDefault();jreviews.moderation.showPredefinedReply(e(this))});t.on("change","div.jr-moderation .jr-reply input",function(t){t.preventDefault();var n=e(this),r=n.closest(".jr-layout-outer").find(".jr-form-reply");r.slideToggle()});t.on("click","div.jr-moderation div.jr-load-more",function(t){t.preventDefault();jreviews.moderation.loadMore(e(this))})},showPredefinedReply:function(t){var n=t.val(),r=t.closest("form"),i=e("div.jr-moderation .jr-predefined-replies");replySubject=r.find("input[name=data\\[Email\\]\\[subject\\]]"),replyBody=r.find(".jr-reply-body");if(n!==""){replyBody.val(i.find("#jr-predefined-reply-"+n).html());replySubject.val(t.find(":selected").text())}else{replyBody.val("");replySubject.val("")}},delModeration:function(t){var n=t.data("lang"),r=t.closest("div.jr-moderation"),i=r.data("processed")||0,s=t.data("id"),o=t.find("span").eq(1),u=t.closest("form").data("object-type"),a=jreviews.getController(t),f=new e.Deferred;f.done(function(n){var o=jreviews.dispatch({method:"get",type:"json",controller:a,action:"_delete",data:{cid:[s]}});o.done(function(s){if(s.success){n.dialog("close");var o=e("#"+u+"_count"),a=Number(o.html());o.html(--a);r.data("processed",++i);t.closest("div.jr-layout-outer").slideUp(500).promise().done(function(){e(this).remove()})}else if(s.str.length){n.dialog("option","buttons",[]);n.html(jreviews.__t(s.str))}else n.dialog("close")})});var l={};l[jreviews.__t("DELETE")]=function(){f.resolve(e(this))};l[jreviews.__t("CANCEL")]=function(){e(this).dialog("close")};e.jrDialog(n.del_confirm,{buttons:l,title:o.html(),width:"640px"});var c=e(".ui-dialog-buttonpane");c.find("button:contains("+jreviews.__t("DELETE")+")").addClass("jrButton").prepend('<span class="jrIconDelete"></span>');c.find("button:contains("+jreviews.__t("CANCEL")+")").addClass("jrButton").prepend('<span class="jrIconCancel"></span>')},moderate:function(t){var n=t.closest("form"),r=t.closest("div.jr-moderation"),i=n.data("object-type"),s=n.closest(".jr-layout-outer"),o=r.data("processed")||0,u;n.find(".jr-moderate-state").each(function(){if(e(this).is(":checked")){u=Number(e(this).val());return!1}});var a=jreviews.dispatch({form:n});a.done(function(t){if(u===0)n.html('<div class="jrWarning">'+jreviews.__t("MODERATION_HELD")+"</div>");else{s.slideUp(500).promise().done(function(){e(this).remove()});var a=e("#"+i+"_count"),f=parseInt(a.html(),10);a.html(--f);r.data("processed",++o);f===0&&a.closest("li").remove()}})},loadMore:function(t){var n=e('<span class="jrLoadingMedium">'),r=t.closest("div.jr-moderation"),i=r.data("pages"),s=parseInt(r.data("page"),10)||2,o=parseInt(r.data("limit"),10),u=parseInt(r.data("processed"),10),a=t.html(),f=t.data("bind");t.html(n);var l=jreviews.dispatch({method:"get",type:"html",controller:f[0],action:f[1],data:{processed:u,page:s,limit:o}});l.done(function(e){t.before(e);t.html(a);r.data("page",s+1);(s===i||e==="")&&t.remove()})}};jreviews.theme={init:function(){var t=jrPage;t.on("click","button.jr-theme-categories",function(e){e.preventDefault()});t.on("click","button.jr-save-theme-settings",function(t){t.preventDefault();var n=e(this),r=n.closest("form"),i="saveCategory",s=jreviews.dispatch({method:"post",type:"text",controller:"admin/themes",action:i,data:r.find("div.jr-table :input").serializeArray()});s.done(function(){jreviews.tools.statusUpdate(jreviews.__t("SETTINGS_SAVED"))})})}};jreviews.menu={init:function(){var t=e("div#jr-admin");t.on("click","a.jr-menu, button.jr-menu",function(t){t.preventDefault();var n=e(this).data("action")||"index";jreviews.menu.load(e(this).data("controller"),n)});t.on("click","a.jr-menu-addon, button.jr-menu-addon",function(n){n.preventDefault();jreviews.menu.loadAddon(e(this),t)});t.on("click","a.jr-main-menu, button.jr-main-menu",function(){jreviews.menu.loadMain(e(this),t)});t.on("click","a#rebuild-reviewer-ranks",function(){jreviews.tools.rebuildReviewerRanks()});t.on("click","a#rebuild-media-counts",function(){jreviews.tools.rebuildMediaCounts()});t.on("click","a#jr-clear-cache-registry",function(t){t.preventDefault();e.post(s2AjaxUri,{"data[controller]":"admin/common","data[action]":"clearCacheRegistry"},function(t){var n=e.jrAlert(t,{buttons:{}});setTimeout(function(){n.dialog("close")},1500)})})},load:function(e,t,n){var r=jrPage;n=n||{};var i=jreviews.dispatch({method:"get",type:"html",controller:"admin/"+e,action:t,data:n});i.done(function(t){r.html(t).find("div.jr-tabs").tabs().fadeIn("fast");r.find('select[multiple="multiple"]').multiselect({minWidth:200,height:"auto",selectedList:3});e=="admin_updater"&&jreviews.installer.setButtonStates()});return i},loadMain:function(t,n){jrPage.jrScrollTo({duration:100});e("#addon_module").slideUp("slow",function(){e("#main_modules").slideDown("slow")})},loadAddon:function(t,n){var r=t.attr("id"),i="menu",s=t.data("controller"),o=t.data("action"),u=jreviews.dispatch({method:"get",type:"html",controller:"admin/common",action:"loadView",data:{folder:r,view:i}});u.done(function(t){e("#main_modules").slideUp(function(){e("#addon_module").html(t).slideDown()})});jreviews.menu.load(s,o)},moderation_counter:function(t){var n=e("#"+t),r=Number(n.html());n.html(--r);r===0&&n.closest("li").remove()}};jreviews.userAutocomplete=function(t){var n=t.find("input.jr-user-autocomplete"),r={target_userid:"jr-user-id-ac",target_name:"jr-user-name-ac",target_username:"jr-user-username-ac",target_email:"jr-user-email-ac"};if(n.val()===""){var i=t.find("."+r.target_userid).val();if(Number(i)>0){var s=jreviews.dispatch({method:"get",type:"text",controller:"users",action:"_getUsername",data:{id:i}});s.done(function(e){n.val(e)})}}n.on("blur",function(){n.val()===""&&t.find("."+r.target_userid+", ."+r.target_email+", ."+r.target_name+", ."+r.target_username).val("")}).autocomplete({source:function(e,t){var r=n.data("cache")||{},i=e.term;if(i in r){t(r[i]);return}var s=jreviews.dispatch({frontend:!0,method:"get",type:"json",controller:"users",action:"_getList",data:{q:i}});s.done(function(e){r[i]=e;n.data("cache",r);t(e)})},select:function(e,n){t.find("."+r.target_userid).val(n.item.id);t.find("."+r.target_email).val(n.item.email);t.find("."+r.target_name).val(n.item.name);t.find("."+r.target_username).val(n.item.username)},minLength:2});e(".ui-autocomplete").css("white-space","nowrap")};jreviews.listingAutocomplete=function(t,n){var r=n.acfield||t.find("input.jr-listing-autocomplete"),i={target_listingid:"jr-listing-id-ac",target_title:"jr-listing-title-ac",target_alias:"jr-listing-alias-ac",target_url:"jr-listing-url-ac"};if(r.val()===""){var s=t.find("."+i.target_listingid).val();if(Number(s)>0){var o=jreviews.dispatch({frontend:!0,method:"get",type:"json",controller:"listings",action:"_getList",data:{id:s}});o.done(function(e){n.onSelect?n.onSelect(r,e[0]):r.val(e[0].value)})}}r.on("blur",function(){r.val()===""&&t.find("."+i.target_listingid+", ."+i.target_title+", ."+i.target_alias+", ."+i.target_url).val("")}).autocomplete({source:function(e,t){var n=r.data("cache")||{},i=e.term;if(i in n){t(n[i]);return}var s=jreviews.dispatch({frontend:!0,method:"get",type:"json",controller:"listings",action:"_getList",data:{search:i}});s.done(function(e){n[i]=e;r.data("cache",n);t(e)})},select:function(e,s){t.find("."+i.target_listingid).val(s.item.id);t.find("."+i.target_title).val(s.item.value);t.find("."+i.target_alias).val(s.item.alias);t.find("."+i.target_url).val(s.item.url);n.onSelect&&n.onSelect(r,s)},minLength:2});e(".ui-autocomplete").css("white-space","nowrap")};jreviews.getController=function(e,t){var n=e.data("object-type"),r=e.closest("form").data("object-type"),i=e.find("form").data("object-type"),s,o;s=n||r||i;switch(s){case"listing":o="admin_listings";break;case"media":o="admin_media";break;case"review":o="admin_reviews";break;case"inquiry":o="admin_inquiry";break;case"claim":o="admin_claims";break;case"discussion":o="admin_discussions";break;case"reply":o="admin_owner_replies";break;case"report":o="admin_reports";break;case"directory":o="directories";break;case"category":o="categories";break;case"group":o="groups";break;case"field":o="fields";break;case"fieldoption":o="fieldoptions";break;case"listing_type":o="listing_types";break;case"configuration":o="configuration";break;case"access":o="access";break;case"theme":o="themes";break;case"seo":o="seo";break;default:o="admin_"+s}return t?o:"admin/"+o};jreviews.tools={apply:function(){jreviews.tools.statusUpdate("Your changes were applied.")},flashRow:function(t){t=typeof t=="string"?e("#"+t):t;t.effect("highlight",{},4e3)},checkAll:function(){var t=jrPage;t.on("change","form#jr-page-form input.jr-cb-all",function(){var n=e(this),r=t.find("form#jr-page-form"),i=r.find("input.jr-row-cb");n.is(":checked")?i.attr("checked","checked"):i.removeAttr("checked")})},rebuildReviewerRanks:function(){e.get(s2AjaxUri,{"data[controller]":"admin/common","data[action]":"_rebuildReviewerRanks"},function(t){e.jrAlert(t)})},rebuildMediaCounts:function(){e.get(s2AjaxUri,{"data[controller]":"admin/common","data[action]":"_rebuildMediaCounts"},function(t){e.jrAlert(t)})},slug:function(t,n){var r={spaceReplaceChar:"",numbers:!0},i=e.extend(r,n),s=t.toLowerCase();s=s.replace(/[\/\|=!$%^&()*;:@#+.,]/g,"");s=s.replace(/[]/ig,"a");s=s.replace(//ig,"ae");s=s.replace(//ig,"c");s=s.replace(/[]/ig,"e");s=s.replace(/[]/ig,"i");s=s.replace(//ig,"n");s=s.replace(/[]/ig,"o");s=s.replace(//ig,"ss");s=s.replace(//ig,"oe");s=s.replace(/[]/ig,"u");s=s.replace(/[]/ig,"y");i.numbers||(s=s.replace(/[0-9]/g,""));s=s.replace(/_/g,i.spaceReplaceChar);s=s.replace(/\s+/g,i.spaceReplaceChar);return s},removeRow:function(t){t=typeof t=="string"?e("#"+row_id):t;t.effect("highlight",{},500).fadeOut("medium",function(){e(this).remove()})},statusUpdate:function(t){e("#jr-status").html(t).fadeIn("medium").delay(1500).fadeOut("slow")}};jreviews.tabs=function(e){e=e||jrPage;e.find("div.jr-tabs").tabs()};jreviews.popup=function(){jrPage.not(".jr-ready-popup").addClass("jr-ready-popup").on("mouseenter",function(){e(this).find
(".jr-more-info").jrPopup({className:"jrPopup",delay:300})})}})(jQuery);(function(e){e.jrDialog=function(t,n){e("div.jr-dialog").dialog("destroy").remove();var r={},i=e('<div class="jr-dialog jrDialogContent jrHidden"></div>');r={title:"",width:"640px",height:"auto",dialogClass:"jrDialog",resizable:!1,modal:!0,autoOpen:!0};r=e.extend(r,n);i.html(t);i.dialog(r);return i};e.jrAlert=function(t,n){var r={dialogClass:"jrDialog",modal:!0,autoOpen:!0,width:"400px",height:"auto",buttons:{OK:function(){e(this).dialog("close")}}},i=e.extend(r,n);e("div.jr-alert").dialog("destroy").remove();var s=e('<div class="jr-alert">'+t+"</div>");s.dialog(i);return s}})(jQuery);(function(e){e.fn.popUpWindow=function(){var t=e(this),n="location=0,menubar=0,resizable=1,scrollbars=0,status=0,toolbar=0",r=t.attr("href"),i=t.html(),s=window.open(r,i,n+",width=800,height=640");s!==null&&s.focus()}})(jQuery);(function(e){e.getCSS=function(t,n){e(document.createElement("link")).attr({href:t,media:n||"screen",type:"text/css",rel:"stylesheet"}).appendTo("head")}})(jQuery);(function(e){e.fn.jrScrollTo=function(t,n){var r=e.extend({},e.fn.jrScrollTo.defaults,t),i=e(this).offset().top+r.offset;e("html,body").animate({scrollTop:i},r.duration,r.easing,n);return e(this)};e.fn.jrScrollTo.defaults={offset:-30,duration:1e3,easing:"swing"}})(jQuery);(function(e){e.fn.tinyMCE=function(){var e=this,t=1e3;try{setTimeout(function(){if(typeof tinyMCE=="object")return e.each(function(){tinyMCE.execCommand("mceAddControl",!1,this.id)})},t)}catch(n){console(n)}};e.fn.RemoveTinyMCE=function(){var e=this;try{if(tinyMCE)return e.each(function(){tinyMCE.execCommand("mceRemoveControl",!0,this.id)})}catch(t){}}})(jQuery);(function(e){var t=function(t,n){this.elem=t;this.$elem=e(t);this.options=e.extend({},e.fn.jrPopup.options,n);this.init()};t.prototype={init:function(){var t=this;t.popupDiv=t.$elem.next("."+t.options.className);if(t.popupDiv.length&&e.trim(t.popupDiv.html())!==""){t.$popupDiv=e(t.popupDiv);t.$elem.hover(function(){t.show()},function(){t.hide()});t.$popupDiv.hover(function(){t.show()},function(){t.hide()})}},show:function(){var e=this,t=e.getPosition();e.$popupDiv.stop(!0,!0);e.clearTimeouts();e.showTimeout=setTimeout(function(){e.$popupDiv.appendTo("body").css({top:t.top,left:t.left});e.$popupDiv.fadeIn(100)},300)},hide:function(){var t=this;t.clearTimeouts();t.showTimeout=setTimeout(function(){e(t.popupDiv).fadeOut(100,function(){t.$elem.after(e(this))})},t.options.delay)},clearTimeouts:function(){if(this.showTimeout){clearTimeout(this.showTimeout);this.showTimeout=0}if(this.showTimeout){clearTimeout(this.showTimeout);this.showTimeout=0}},getPosition:function(){var e=this.$elem.offset().top,t=this.$elem.offset().left,n=this.$elem.outerWidth(),r=this.$elem.outerHeight();return{left:t+n/2-this.$popupDiv.outerWidth()/2+"px",top:e-this.$popupDiv.outerHeight()-15+"px"}}};e.fn.jrPopup=function(e){return this.each(function(){new t(this,e)})};e.fn.jrPopup.options={className:"jrPopup",delay:300}})(jQuery);(function(e){var t=function(e){if(typeof e!="string")throw"sprintf: The first arguments need to be a valid format string.";var t=new RegExp(/%(\+)?([0 ]|'(.))?(-)?([0-9]+)?(\.([0-9]+))?([%bcdfosxX])/g),n=[],r=1;while(part=t.exec(e)){if(r>=arguments.length)throw"sprintf: At least one argument was missing.";n[n.length]={begin:part.index,end:part.index+part[0].length,sign:part[1]=="+",negative:parseInt(arguments[r])<0?!0:!1,padding:part[2]==undefined?" ":part[2].substring(0,1)=="'"?part[3]:part[2],alignLeft:part[4]=="-",width:part[5]!=undefined?part[5]:!1,precision:part[7]!=undefined?part[7]:!1,type:part[8],data:part[8]!="%"?String(arguments[r++]):!1}}var i="",s=0;for(var o=0;o<n.length;++o){i+=e.substring(s,n[o].begin);s=n[o].end;var u="";switch(n[o].type){case"%":u="%";break;case"b":u=Math.abs(parseInt(n[o].data)).toString(2);break;case"c":u=String.fromCharCode(Math.abs(parseInt(n[o].data)));break;case"d":u=String(Math.abs(parseInt(n[o].data)));break;case"f":u=n[o].precision==0?String(Math.abs(parseFloat(n[o].data))):Math.abs(parseFloat(n[o].data)).toFixed(n[o].precision);break;case"o":u=Math.abs(parseInt(n[o].data)).toString(8);break;case"s":u=n[o].data.substring(0,n[o].precision?n[o].precision:n[o].data.length);break;case"x":u=Math.abs(parseInt(n[o].data)).toString(16).toLowerCase();break;case"X":u=Math.abs(parseInt(n[o].data)).toString(16).toUpperCase();break;default:throw'sprintf: Unknown type "'+n[o].type+'" detected. This should never happen. Maybe the regex is wrong.'}if(n[o].type=="%"){i+=u;continue}if(n[o].width!=0&&n[o].width>u.length){var a=u.length;for(var f=0;f<n[o].width-a;++f)u=n[o].alignLeft==1?u+n[o].padding:n[o].padding+u}if(n[o].type=="b"||n[o].type=="d"||n[o].type=="o"||n[o].type=="f"||n[o].type=="x"||n[o].type=="X")n[o].negative==1?u="-"+u:n[o].sign==1&&(u="+"+u);i+=u}i+=e.substring(s,e.length);return i};e.sprintf=t;String.prototype.printf=function(){var e=Array.prototype.slice.call(arguments);e.unshift(String(this));return t.apply(undefined,e)}})(window);